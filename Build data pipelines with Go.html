<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Build data pipelines with Go</title>
    
    <script>
      var notesEnabled =  false ;
    </script>
    <script src="./Build data pipelines with Go_files/slides.js"></script>

    

    <script>
      
      if (window["location"] && window["location"]["hostname"] == "talks.golang.org") {
        var _gaq = _gaq || [];
        _gaq.push(["_setAccount", "UA-11222381-6"]);
        _gaq.push(["b._setAccount", "UA-49880327-6"]);
        window.trackPageview = function() {
          _gaq.push(["_trackPageview", location.pathname+location.hash]);
          _gaq.push(["b._trackPageview", location.pathname+location.hash]);
        };
        window.trackPageview();
        window.trackEvent = function(category, action, opt_label, opt_value, opt_noninteraction) {
          _gaq.push(["_trackEvent", category, action, opt_label, opt_value, opt_noninteraction]);
          _gaq.push(["b._trackEvent", category, action, opt_label, opt_value, opt_noninteraction]);
        };
      }
    </script>
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"></head>

  <body style="display: none" class="loaded">

    <section class="slides layout-widescreen">

      <article class="current">
        <h1>Build data pipelines with Go</h1>
        
        
        
          <div class="presenter">
            
  
  <p>
    30 Jul 2019
  </p>
  

          </div>
        
          <div class="presenter">
            
  
  <p>
    Edouard Buschini
  </p>
  

          </div>
        
          <div class="presenter">
            
          </div>
        
      </article>

  
  
      <article class="next">
      
        <h3>whoami </h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>Sysadmin for 7 years</li>
  
    <li>Currently DevOps engineer for 3 years</li>
  
    <li>I <b>LOVE</b> computers</li>
  
    <li>Also currently doing infosec stuff for work/spare time</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">2</span>
      </article>
  
  
  
      <article class="far-next">
      
        <h3>Why this talk</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>I love playing with data (but not data science or UI)</li>
  
    <li>I love Go</li>
  
    <li>Promote my tool</li>
  
  </ul>
<p class="link"><a href="https://github.com/tehmoon/cryptocli" target="_blank">github.com/tehmoon/cryptocli</a></p>
				</div>
      
      <span class="pagenumber">3</span>
      </article>
  
  
  
      <article>
      
        <h3>Agenda</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>Pipeline high level</li>
  
    <li>Dive into the modules</li>
  
    <li>Data flowing through</li>
  
    <li>Implementation</li>
  
    <li>Examples with Cryptocli</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">4</span>
      </article>
  
  
  
      <article>
      
        <h3>Pipeline 101</h3>
				<div style="top: 25%;position: absolute;">
        
  <div class="code">


<pre><span num="1">     +--------------+    </span>
<span num="2">     |              |    </span>
<span num="3">+--&gt; |   Pipeline   +----&gt;</span>
<span num="4">  in |              | out</span>
<span num="5">     +--------------+</span>
</pre>


</div>

  <ul>
  
    <li>Data comes from IN</li>
  
    <li>Gets processed</li>
  
    <li>And goes out from OUT</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">5</span>
      </article>
  
  
  
      <article>
      
        <h3>Anatomy of a pipeline</h3>
				<div style="top: 25%;position: absolute;">
        
  <div class="code">


<pre><span num="1">        +------------+          +------------+</span>
<span num="2">        |            |          |            |</span>
<span num="3">+-----&gt; |   Module   +--------&gt; |   Module   +----&gt;</span>
<span num="4">     in |            | out   in |            | out</span>
<span num="5">        +------------+          +------------+</span>
</pre>


</div>

  <ul>
  
    <li>Made of modules</li>
  
    <li>They all are patched to each other</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">6</span>
      </article>
  
  
  
      <article>
      
        <h3>Anatomy of a module</h3>
				<div style="top: 25%;position: absolute;">
        
  
  <p>
    Let's look at the <b>tcp-server</b> module
  </p>
  

  <div class="code">


<pre><span num="1">    +----------------+</span>
<span num="2">    |                |</span>
<span num="3">    |   tcp-server   |</span>
<span num="4">    |                |</span>
<span num="5">+--------+     +----------&gt;</span>
<span num="6"> in |    |     |     | out</span>
<span num="7">    |    |     |     |</span>
<span num="8">    |    |     |     |</span>
<span num="9">    |    v     +     |</span>
<span num="10">    | write   read   |</span>
<span num="11">    |     socket     |</span>
<span num="12">    |                |</span>
<span num="13">    +----------------+</span>
</pre>


</div>

  <ul>
  
    <li>Data that goes in the module, goes out of the socket</li>
  
    <li>Data that goes in the socket, goes out of the module</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">7</span>
      </article>
  
  
  
      <article>
      
        <h3>Pipelines are awesome</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>They can be patched together</li>
  
  </ul>

  <div class="code">


<pre><span num="1">     +--------------+         +--------------+    </span>
<span num="2">     |              |         |              |    </span>
<span num="3">+--&gt; |   Pipeline   +-------&gt; |   Pipeline   +----&gt;</span>
<span num="4">  in |              | out  in |              | out</span>
<span num="5">     +--------------+         +--------------+</span>
</pre>


</div>

  <ul>
  
    <li>Or patched to itself!</li>
  
  </ul>

  <div class="code">


<pre><span num="1">+------------------------+</span>
<span num="2">|                        |</span>
<span num="3">|    +--------------+    |</span>
<span num="4">|    |              |    |</span>
<span num="5">+--&gt; |   Pipeline   +----+</span>
<span num="6">  in |              | out</span>
<span num="7">     +--------------+</span>
</pre>


</div>

				</div>
      
      <span class="pagenumber">8</span>
      </article>
  
  
  
      <article>
      
        <h3>This is not a new thing</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>Unix pipelines</li>
  
  </ul>
<p class="link"><a href="https://youtu.be/tc4ROCJYbm0?t=300" target="_blank">youtu.be/tc4ROCJYbm0?t=300</a></p>
  <ul>
  
    <li>Flow based programming</li>
  
  </ul>
<p class="link"><a href="https://en.wikipedia.org/wiki/Flow-based_programming" target="_blank">en.wikipedia.org/wiki/Flow-based_programming</a></p>
				</div>
      
      <span class="pagenumber">9</span>
      </article>
  
  
  
      <article>
      
        <h3>Let's talk about data</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>Modules don't know the overall pipeline</li>
  
    <li>Modules read <b>[]bytes</b> and produce <b>[]bytes</b></li>
  
    <li>Modules <b>own</b> the data</li>
  
  </ul>

  
  <div class="code"><pre>They can change it
They can discard it
They can produce more!</pre></div>
  

  <ul>
  
    <li>Modules <b>do</b> <b>not</b> keep pointers to old data</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">10</span>
      </article>
  
  
  
      <article>
      
        <h3>Connecting modules</h3>
				<div style="top: 25%;position: absolute;">
        
  
  <p>
    Channels!
  </p>
  

  
  <div class="code"><pre>Do not communicate by sharing memory; instead, share memory by communicating.</pre></div>
  

  <ul>
  
    <li>They can be buffered</li>
  
    <li>They can use whatever type we want</li>
  
    <li>They synchronise goroutines</li>
  
    <li>They can be closed!</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">11</span>
      </article>
  
  
  
      <article>
      
        <h3>Lifecycle of a pipeline</h3>
				<div style="top: 25%;position: absolute;">
        
  
  <p>
    Start all modules
  </p>
  

  <div class="code">


<pre><span num="7">type Module interface{</span>
<span num="8">    Init() (error)</span>
<span num="9">}</span>
</pre>


</div>

  
  <p>
    Signals
  </p>
  

  <div class="code">


<pre><span num="19">type MessageType int</span>
</pre>


</div>

  <div class="code">


<pre><span num="13">    MessageTypeReset    MessageType = iota</span>
<span num="14">    MessageTypeData</span>
<span num="15">    MessageTypeClose</span>
</pre>


</div>

  <div class="code">


<pre><span num="21">type Message struct{</span>
<span num="22">    Type MessageType</span>
<span num="23">    Payload []byte</span>
<span num="24">}</span>
</pre>


</div>

				</div>
      
      <span class="pagenumber">12</span>
      </article>
  
  
  
      <article>
      
        <h3>Implementation</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>The <b>Module</b> interface</li>
  
    <li>The <b>Message</b> structure</li>
  
    <li>Our first module: <b>generate-text</b></li>
  
    <li>Our second module: <b>stdout</b></li>
  
    <li>Creating the pipeline</li>
  
    <li>Finally, the feedback loop</li>
  
  </ul>

				</div>
      
      <span class="pagenumber">13</span>
      </article>
  
  
  
      <article>
      
        <h3>Examples:</h3>
				<div style="top: 25%;position: absolute;">
        
  <ul>
  
    <li>aes-gcm encrypted chat wrapped in a websocket connection with logging to file</li>
  
  </ul>

  <div class="code">


<pre><span num="1">set -x; read -s pwd; pwd=$pwd cryptocli \</span>
<span num="2">  -- stdin -- gzip \</span>
<span num="3">  -- aes-gcm --encrypt --password-in "env --var pwd" \</span>
<span num="4">  -- tee --pipe \</span>
<span num="5">        "fork jq -Rc --unbuffered '{"s": . | @base64}' -- file --append --write --path /tmp/logs.txt" \</span>
<span num="6">  -- websocket-server --connect-timeout 10m --addr :8080 \</span>
<span num="7">  -- tee --pipe \</span>
<span num="8">        "fork jq -Rc --unbuffered '{"r": . | @base64}' -- file --append --write --path /tmp/logs.txt" \</span>
<span num="9">  -- aes-gcm --decrypt --password-in "env --var pwd" \</span>
<span num="10">  -- gunzip -- stdout</span>
</pre>


</div>

  <div class="code">


<pre><span num="1">set -x; read -s pwd; pwd=$pwd cryptocli \</span>
<span num="2">  -- stdin -- gzip \</span>
<span num="3">  -- aes-gcm --encrypt --password-in "env --var pwd" \</span>
<span num="4">  -- websocket --url ws://localhost:8080 \</span>
<span num="5">  -- aes-gcm --decrypt --password-in "env --var pwd" \</span>
<span num="6">  -- gunzip -- stdout</span>
</pre>


</div>

				</div>
      
      <span class="pagenumber">14</span>
      </article>
  
  

      <article>
        <h3>Thank you</h3>
        
          <div class="presenter">
            
  
  <p>
    30 Jul 2019
  </p>
  

          </div>
        
          <div class="presenter">
            
  
  <p>
    Edouard Buschini
  </p>
  

          </div>
        
          <div class="presenter">
            <p class="link"><a href="mailto:edouard.buschini@gmail.com" target="_blank">edouard.buschini@gmail.com</a></p><p class="link"><a href="https://medium.com/@ebuschini" target="_blank">https://medium.com/@ebuschini</a></p><p class="link"><a href="https://github.com/tehmoon" target="_blank">https://github.com/tehmoon</a></p><p class="link"><a href="http://twitter.com/moonbocal" target="_blank">@moonbocal</a></p>
          </div>
        
      </article>

    <div class="slide-area" id="prev-slide-area"></div><div class="slide-area" id="next-slide-area"></div></section>

    <div id="help" style="display: none;">
      Use the left and right arrow keys or click the left and right
      edges of the page to navigate between slides.<br>
      (Press 'H' or navigate to hide this message.)
    </div>

    
    <script src="./Build data pipelines with Go_files/play.js"></script>
    

    <script>
      (function() {
        
        if (window["location"] && window["location"]["hostname"] == "talks.golang.org") {
          var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
          ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
          var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
        }
      })();
    </script>
  

<link rel="stylesheet" type="text/css" href="./Build data pipelines with Go_files/style.css"><link rel="stylesheet" type="text/css" href="./Build data pipelines with Go_files/styles.css"></body></html>